<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AlphaSports - Loja de Esportes</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>
<!-- Top Bar -->
<div class="top-bar">
    <div class="container top-bar-content">
        <span>Frete grátis para todos os produtos</span>
        <span>Atendimento: (42) 99837-9401</span>
    </div>
</div>

<!-- Header -->
<header class="header">
    <div class="container header-content">
        <a href="/" class="logo">
            <img th:src="@{/images/Logo.png}" alt="AlphaSports">
        </a>

        <div class="search-bar">
            <input type="text" placeholder="Buscar produtos..." id="searchInput">
            <button class="search-btn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg>
            </button>
        </div>

        <nav class="header-nav">
            <div class="nav-link user-dropdown-container" id="userInfo">
                <a th:href="@{/login}" class="nav-link user-link" id="userLink">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
                    <span id="userName">Entrar</span>
                </a>
            </div>
            <a th:href="@{/carrinho}" class="nav-link cart-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="8" cy="21" r="1"></circle><circle cx="19" cy="21" r="1"></circle><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"></path></svg>
                <span>Carrinho</span>
                <span class="cart-count" id="cartCount">0</span>
            </a>

            <a href="#" onclick="fazerLogout(event)"  class="nav-link cart-link">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path><polyline points="16 17 21 12 16 7"></polyline><line x1="21" y1="12" x2="9" y2="12"></line></svg>
                Sair
            </a>
        </nav>

        <button class="mobile-menu-btn" id="mobileMenuBtn">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg>
        </button>
    </div>

    <!-- Categories Nav -->
    <nav class="categories-nav">
        <div class="container">
            <ul class="categories-list">
                <li><a th:href="@{/produtos(categoria=todos)}">Todos</a></li>
                <li><a th:href="@{/produtos(categoria=calcados)}">Calçados</a></li>
                <li><a th:href="@{/produtos(categoria=roupas)}">Roupas</a></li>
                <li><a th:href="@{/produtos(categoria=equipamentos)}">Equipamentos</a></li>
                <li><a th:href="@{/produtos(categoria=futebol)}">Futebol</a></li>
                <li><a th:href="@{/produtos(categoria=corrida)}">Corrida</a></li>
                <li><a th:href="@{/produtos(categoria=fitness)}">Fitness</a></li>
                <li><a th:href="@{/produtos}" class="promo-link">Promoções</a></li>
            </ul>
        </div>
    </nav>
</header>

<!-- Mobile Menu -->
<div class="mobile-menu" id="mobileMenu">
    <div class="mobile-menu-header">
        <span>Menu</span>
        <button class="close-menu" id="closeMenu">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>
        </button>
    </div>
    <nav class="mobile-nav">
        <a th:href="@{/login}" id="mobileUserLink">Entrar / Cadastrar</a>
        <a th:href="@{/produtos(categoria=todos)}">Todos</a>
        <a th:href="@{/produtos(categoria=calcados)}">Calçados</a>
        <a th:href="@{/produtos(categoria=roupas)}">Roupas</a>
        <a th:href="@{/produtos(categoria=equipamentos)}">Equipamentos</a>
        <a th:href="@{/produtos(categoria=futebol)}">Futebol</a>
        <a th:href="@{/produtos(categoria=corrida)}">Corrida</a>
        <a th:href="@{/produtos(categoria=fitness)}">Fitness</a>
        <a th:href="@{/carrinho}">Carrinho</a>
    </nav>
</div>

<!-- Hero Banner -->
<section class="banner-slider">
    <div class="banner-slide active">
        <a th:href="@{/produtos}">
            <img th:src="@{/images/banner1.png}" alt="AlphaSports">
        </a>
    </div>
    <div class="banner-slide">
        <a th:href="@{/produtos}">
            <img th:src="@{/images/banner2.png}" alt="AlphaSports">
        </a>
    </div>

    <button id="prevSlide" class="banner-btn prev">◀</button>
    <button id="nextSlide" class="banner-btn next">▶</button>

    <div class="banner-dots">
        <span class="dot active"></span>
        <span class="dot"></span>
    </div>
</section>

<!-- Categories Section -->
<section class="section categories-section">
    <div class="container">
        <h2 class="section-title">Categorias</h2>
        <div class="categories-grid">
            <a th:href="@{/produtos(categoria=todos)}" class="category-card">
                <div class="category-icon">
                    <img th:src="@{/images/todos.png}" alt="Todos os Produtos">
                </div>
                <span>Todos</span>
            </a>
            <a th:href="@{/produtos(categoria=calcados)}" class="category-card">
                <div class="category-icon">
                    <img th:src="@{/images/calcados.png}" alt="Calçados">
                </div>
                <span>Calçados</span>
            </a>
            <a th:href="@{/produtos(categoria=roupas)}" class="category-card">
                <div class="category-icon">
                    <img th:src="@{/images/roupas.png}" alt="Roupas">
                </div>
                <span>Roupas</span>
            </a>
            <a th:href="@{/produtos(categoria=equipamentos)}" class="category-card">
                <div class="category-icon">
                    <img th:src="@{/images/equipamentos.png}" alt="Equipamentos">
                </div>
                <span>Equipamentos</span>
            </a>
            <a th:href="@{/produtos(categoria=futebol)}" class="category-card">
                <div class="category-icon">
                    <img th:src="@{/images/futebol.png}" alt="Futebol">
                </div>
                <span>Futebol</span>
            </a>
            <a th:href="@{/produtos(categoria=corrida)}" class="category-card">
                <div class="category-icon">
                    <img th:src="@{/images/corrida.png}" alt="Corrida">
                </div>
                <span>Corrida</span>
            </a>
        </div>
    </div>
</section>

<!-- Best Sellers Section -->
<section class="section">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Mais Vendidos</h2>
            <a th:href="@{/produtos}" class="see-all">Ver todos</a>
        </div>
        <div class="products-grid" id="bestSellersGrid">
            <!-- Products will be inserted by JavaScript from database -->
        </div>
    </div>
</section>

<!-- Promo Banner -->
<section class="promo-section">
    <div class="container">
        <div class="promo-banner">
            <div class="promo-content">
                <h2>Cadastre-se e ganhe até 50% OFF</h2>
                <p>Na sua primeira compra</p>
                <a th:href="@{/cadastro}" class="btn btn-white">Cadastrar Agora</a>
            </div>
        </div>
    </div>
</section>

<!-- Brands Section -->
<section class="section brands-section">
    <div class="container">
        <h2 class="section-title">Marcas</h2>
        <div class="brands-grid">
            <a th:href="@{/produtos(marca=nike)}" class="brand-card">
                <img th:src="@{/images/nike logo.png}" alt="Nike" class="nike">
            </a>
            <a th:href="@{/produtos(marca=adidas)}" class="brand-card">
                <img th:src="@{/images/adidas logo.png}" alt="Adidas" class="adidas">
            </a>
            <a th:href="@{/produtos(marca=puma)}" class="brand-card">
                <img th:src="@{/images/puma logo.png}" alt="Puma" class="puma">
            </a>
            <a th:href="@{/produtos(marca=mizuno)}" class="brand-card">
                <img th:src="@{/images/mizuno logo.png}" alt="Mizuno" class="mizuno">
            </a>
            <a th:href="@{/produtos(marca=asics)}" class="brand-card">
                <img th:src="@{/images/asics logo.png}" alt="Asics" class="asics">
            </a>
            <a th:href="@{/produtos(marca=under-armour)}" class="brand-card">
                <img th:src="@{/images/under armour logo.png}" alt="Under Armour" class="under-armour">
            </a>
        </div>
    </div>
</section>

<!-- New Arrivals Section -->
<section class="section">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Lançamentos</h2>
            <a th:href="@{/produtos}" class="see-all">Ver todos</a>
        </div>
        <div class="products-grid" id="newArrivalsGrid">
            <!-- Products will be inserted by JavaScript from database -->
        </div>
    </div>
</section>

<!-- Footer -->
<footer class="footer">
    <div class="container">
        <div class="footer-grid">
            <div class="footer-col">
                <img th:src="@{/images/Logo.png}" alt="AlphaSports" class="footer-logo">
                <p>Sua loja de artigos esportivos com as melhores marcas e preços.</p>
                <div class="social-links">
                    <a href="#" aria-label="Facebook">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
                    </a>
                    <a href="#" aria-label="Instagram">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="20" height="20" x="2" y="2" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" x2="17.51" y1="6.5" y2="6.5"></line></svg>
                    </a>
                </div>
            </div>
            <div class="footer-col">
                <h4>Institucional</h4>
                <ul>
                    <li><a href="#">Sobre Nós</a></li>
                    <li><a href="#">Nossas Lojas</a></li>
                    <li><a href="#">Trabalhe Conosco</a></li>
                    <li><a href="#">Política de Privacidade</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>Ajuda</h4>
                <ul>
                    <li><a href="#">Central de Atendimento</a></li>
                    <li><a href="#">Trocas e Devoluções</a></li>
                    <li><a href="#">Prazo de Entrega</a></li>
                    <li><a href="#">Formas de Pagamento</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4>Minha Conta</h4>
                <ul>
                    <li><a href="#">Meus Pedidos</a></li>
                    <li><a th:href="@{/carrinho}">Carrinho</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 AlphaSports. Todos os direitos reservados.</p>
        </div>
    </div>
</footer>

<script th:src="@{/js/script.js}"></script>

<script>
    async function atualizarHeader() {
        try {
            const response = await fetch('/api/auth/verificar', {
                credentials: 'include'
            });

            if (response.ok) {
                const data = await response.json();
                const userName = document.getElementById('userName');
                const userLink = document.getElementById('userLink');
                const mobileUserLink = document.getElementById('mobileUserLink');

                const primeiroNome = data.nome.split(' ')[0];
                userName.textContent = `Olá, ${primeiroNome}`;
                mobileUserLink.textContent = `Olá, ${primeiroNome}`;
                userLink.href = "javascript:void(0)";

                userLink.onclick = (event) => {
                    event.preventDefault();
                    if (data.cargo === 'ADMINISTRADOR' || data.role === 'ADMIN') {
                        window.location.href = '/admin';
                    } else {
                        window.location.href = '/perfil';
                    }
                };
                mobileUserLink.onclick = userLink.onclick;
                mobileUserLink.href = "javascript:void(0)";
            }
        } catch (error) {
            console.error('Erro ao verificar autenticação:', error);
        }
    }

    const slides = document.querySelectorAll('.banner-slide');
    const dots = document.querySelectorAll('.dot');
    const nextBtn = document.getElementById('nextSlide');
    const prevBtn = document.getElementById('prevSlide');

    let currentIndex = 0;
    let autoSlideInterval;

    function showSlide(index) {
        slides.forEach((slide, i) => {
            slide.classList.toggle('active', i === index);
            dots[i].classList.toggle('active', i === index);
        });
    }

    function nextSlide() {
        currentIndex = (currentIndex + 1) % slides.length;
        showSlide(currentIndex);
    }

    function prevSlide() {
        currentIndex = (currentIndex - 1 + slides.length) % slides.length;
        showSlide(currentIndex);
    }

    function startAutoSlide() {
        autoSlideInterval = setInterval(nextSlide, 10000); // 10 segundos
    }

    function resetAutoSlide() {
        clearInterval(autoSlideInterval);
        startAutoSlide();
    }

    nextBtn.addEventListener('click', () => {
        nextSlide();
        resetAutoSlide();
    });

    prevBtn.addEventListener('click', () => {
        prevSlide();
        resetAutoSlide();
    });

    dots.forEach((dot, index) => {
        dot.addEventListener('click', () => {
            currentIndex = index;
            showSlide(currentIndex);
            resetAutoSlide();
        });
    });

    // Inicia
    showSlide(currentIndex);
    startAutoSlide();

    async function fazerLogout(event) {
        event.preventDefault();

        try {
            const response = await fetch('/api/auth/logout', {
                method: 'POST',
                credentials: 'include'
            });

            if (response.ok) {
                localStorage.removeItem('alphasports_user');
                if (typeof showToast === 'function') {
                    showToast('Logout realizado com sucesso!', 'success');
                }
                setTimeout(() => {
                    window.location.href = '/login';
                }, 1000);
            }
        } catch (error) {
            console.error('Erro ao fazer logout:', error);
        }
    }

    atualizarHeader();
</script>
</body>
</html>